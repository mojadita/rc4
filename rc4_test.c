/* $Id: rc4_test.c,v 1.1 2003/12/11 21:35:13 luis Exp $
 * Author: Luis Colorado <Luis.Colorado@HispaLinux.ES>
 * Date: Thu Dec 11 11:52:13 MET 2003
 *
 * Disclaimer:
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *  
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 */

#define IN_RC4_TEST_C

/* Standard include files */
#include <sys/types.h>
#include <sys/time.h>
#include <sys/socket.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <fcntl.h>
#include <unistd.h>
#include <time.h>
#include "fprintbuf.h"
#include "rc4.h"

/* constants */

/* types */

/* prototypes */

/* variables */
static char RC4_MAIN_C_RCSId[]="\n$Id: rc4_test.c,v 1.1 2003/12/11 21:35:13 luis Exp $\n";

/* functions */

/* main program */
int main()
{
	RC4STATUS *s = new_rc4status(RC4MOD);
	char texto[] = "Arriba cachipurriana";
	size_t lon = strlen(texto);
	char clave[] = {
		0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,
		0x0f,0x0e,0x0d,0x0c,0x0b,0x0a,0x09,0x08,
		0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,
		0x1f,0x1e,0x1d,0x1c,0x1b,0x1a,0x19,0x18,
		0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,
		0x0f,0x0e,0x0d,0x0c,0x0b,0x0a,0x09,0x08,
		0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,
		0x1f,0x1e,0x1d,0x1c,0x1b,0x1a,0x19,0x18,
		
		0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,
		0x0f,0x0e,0x0d,0x0c,0x0b,0x0a,0x09,0x08,
		0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,
		0x1f,0x1e,0x1d,0x1c,0x1b,0x1a,0x19,0x18,
		0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,
		0x0f,0x0e,0x0d,0x0c,0x0b,0x0a,0x09,0x08,
		0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,
		0x1f,0x1e,0x1d,0x1c,0x1b,0x1a,0x19,0x18,
		
		0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,
		0x0f,0x0e,0x0d,0x0c,0x0b,0x0a,0x09,0x08,
		0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,
		0x1f,0x1e,0x1d,0x1c,0x1b,0x1a,0x19,0x18,
		0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,
		0x0f,0x0e,0x0d,0x0c,0x0b,0x0a,0x09,0x08,
		0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,
		0x1f,0x1e,0x1d,0x1c,0x1b,0x1a,0x19,0x18,
		
		0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,
		0x0f,0x0e,0x0d,0x0c,0x0b,0x0a,0x09,0x08,
		0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,
		0x1f,0x1e,0x1d,0x1c,0x1b,0x1a,0x19,0x18,
		0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,
		0x0f,0x0e,0x0d,0x0c,0x0b,0x0a,0x09,0x08,
		0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,
		0x1f,0x1e,0x1d,0x1c,0x1b,0x1a,0x19,0x18,
	};
		

	fprintbuf(stdout, lon, (unsigned char *)texto, -1, -1, "Texto a cifrar");

	fprintf(stdout, "Clave nula (256 NULL's)\n");
	rc4init(s, NULL, 0); /* key is 0's */
	rc4cipher(s, (RC4 *)texto, lon);
	fprintbuf(stdout, lon, (unsigned char *)texto, -1, -1, "Texto Cifrado");

	rc4init(s, NULL, 0);
	rc4uncipher(s, (RC4 *)texto, lon);
	fprintbuf(stdout, lon, (unsigned char *)texto, -1, -1, "Texto descifrado");

	fprintbuf(stdout, sizeof clave, (unsigned char *)clave, -1, -1, "Clave de cifrado:");
	rc4init(s, (RC4 *)clave, sizeof clave);
	rc4cipher(s, (RC4 *)texto, lon);
	fprintbuf(stdout, lon, (unsigned char *)texto, -1, -1, "Texto Cifrado");

	rc4init(s, (RC4 *)clave, sizeof clave);
	rc4cipher(s, (RC4 *)texto, lon);
	fprintbuf(stdout, lon, (unsigned char *)texto, -1, -1, "Texto descifrado");

} /* main */

/* $Id: rc4_test.c,v 1.1 2003/12/11 21:35:13 luis Exp $ */
